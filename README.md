# upgradefor-page-generator

## База данных (Prisma, этап 1)

Этот этап подготавливает структуру базы данных для будущих аккаунтов и авторизации.

Используется PostgreSQL и Prisma.

---

## Авторизация (Auth.js, этап 2)

На этом этапе реализован вход и выход пользователей по email и паролю,
а также защищённая страница личного кабинета `/account`.

Что уже есть:
- вход через `/account/login`
- защищённая страница `/account`
- выход из аккаунта
- тестовый пользователь создаётся через скрипт
- используются существующие модели пользователя

Регистрация, подтверждение email и восстановление пароля добавлены на следующих этапах.

---

## Регистрация и подтверждение email (этап 3)

На этом этапе добавлена регистрация и подтверждение email через письмо.

### Переменные окружения для почты

Используется Resend API. Базовый URL для ссылок берётся из `NEXTAUTH_URL`.

Добавьте в `.env`:

```env
EMAIL_FROM="noreply@upgradefor.com"
EMAIL_PROVIDER="resend"
RESEND_API_KEY=""
```

---

## Навигация и Layout (обязательная архитектура)

Навигация (`Header` + `Sidebar`) рендерится **только** через единый `app/layout.tsx`.
Любые динамические вставки навигации, HTML-includes и `load-layout.js` запрещены.

### Проверки для CI

Запускайте в CI:

```bash
npm run test:layout
npm run check:layout
```

Эти проверки гарантируют:
- snapshot LayoutShell
- наличие `Header` и `Sidebar` в layout-дереве
- отсутствие ссылок на `load-layout.js` внутри `app/` и `components/`

---

## Восстановление пароля (этап 4)

На этом этапе добавлено восстановление пароля через email.

Что уже есть:
- запрос ссылки на восстановление через `/account/forgot`
- установка нового пароля через `/account/reset`
- письма на восстановление отправляются через Resend

### Переменные окружения для почты

Используется Resend API. Базовый URL для ссылок берётся из `NEXTAUTH_URL`.

Добавьте в `.env`:

```env
EMAIL_FROM="noreply@upgradefor.com"
EMAIL_PROVIDER="resend"
RESEND_API_KEY=""
```
