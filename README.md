# upgradefor-page-generator

## База данных (Prisma, этап 1)

Этот этап подготавливает структуру базы данных для будущих аккаунтов и авторизации.

Используется PostgreSQL и Prisma.

---

## Авторизация (Auth.js, этап 2)

На этом этапе реализован вход и выход пользователей по email и паролю,
а также защищённая страница личного кабинета `/account`.

Что уже есть:
- вход через `/account/login`
- защищённая страница `/account`
- выход из аккаунта
- тестовый пользователь создаётся через скрипт
- используются существующие модели пользователя

Регистрация, подтверждение email и восстановление пароля будут добавлены на следующем этапе.

---

## Регистрация и подтверждение email (этап 3)

На этом этапе добавлена регистрация и подтверждение email через письмо.

### Переменные окружения для почты

Используется Resend API. Базовый URL для ссылок берётся из `NEXTAUTH_URL`.

Добавьте в `.env`:

```env
EMAIL_FROM="noreply@upgradefor.com"
EMAIL_PROVIDER="resend"
RESEND_API_KEY=""
```

### Как проверить вручную

1. Откройте `/account/register`.
2. Зарегистрируйтесь с новым email и паролем.
3. Проверьте консоль сервера (в dev), чтобы увидеть ссылку подтверждения, либо получите письмо через Resend.
4. Откройте ссылку вида `/account/verify?token=...`.
5. После успешного подтверждения войдите через `/account/login`.
6. Убедитесь, что `/account` доступен.

---

## Восстановление пароля (этап 4)

На этом этапе добавлено восстановление пароля через email.

### Как проверить вручную

1. Откройте `/account/forgot`.
2. Введите email существующего пользователя и отправьте форму.
3. Проверьте консоль сервера (в dev) или письмо, чтобы получить ссылку вида `/account/reset?token=...`.
4. Откройте ссылку и задайте новый пароль.
5. Войдите через `/account/login` с новым паролем.
